# 2.4 스프링 테스트 적용(p.183 ~ 196)

  - 현재 테스트 코드의 문제저는 애플리케이션 컨텍스트 생성 방식이다.

    - @Before 메소드가 테스트 메소드 개수만큼 반복되기 때문에 애플리케이션 컨텍스트도 세 번 만들어진다.

      - 빈이 많아지고 복잡해지면 애플리케이션 컨텍스트 생성에 적지 않은 시간이 걸릴 수 있다.
 
    - 애플리케이션 컨텍스트가 만들어질 때는 모든 싱글톤 빈 오브젝트를 초기화한다.

      - 단순히 빈 오브젝트를 만드는 정도라면 상관없지만, 어떤 빈은 오브젝트가 생성될 때 자체적인 초기화 작업을 진행해서 제법 많은 시간을 필요로 하기 때문이다

    - 애플리케이션 컨텍스트가 초기화될 때 어떤 빈은 독자적으로 많은 리소스를 할당하거나 독집적인 스레드를 띄우기도 한다.

      - 테스트를 마칠 때마다 애플리케이션 컨텍스트 내의 빈이 할당한 리소스 등을 깔끔하게 정리해주지 않으면 다음 테스트에서 새로운 애플리케이션 컨텍스트가 만들어지면서 문제를 일으킬 수도 있다.

  - 테스트는 가능한 한 독립적으로 매번 새로운 오브젝트를 만들어서 사용하는 것이 원칙이지만, 애플리케이션 컨텍스트처럼 생성에 많은 시간과 자원이 소모되는 경우에는 테스트 전체가 공유하는 오브젝트를 만들기도 한다.

  - 테스트는 일관성 있는 실행 결과를 보장해야하고, 테스트의 실행 순서가 결과에 영향을 미치지 않아야 한다.

     - 애플리케이션 컨텍스트는 초기화되고 나면 내부의 상태가 바뀌는 일은 거의 없다.

     - 빈은 싱글톤으로 만들었기 때문에 상태를 갖지 않는다.

       - UserDao 빈을 가져다가 add(), get() 메소드 등을 사용한다고 해서 UserDao 빈의 상태가 바뀌진 않는다.

       - DB의 상태는 각 테스트에서 알아서 관리할 것이므로 문제가 되지 않는다. 애플리케이션 컨텍스트는 한 번만 만들고 여러 테스트가 공유해서 사용해도 된다.  