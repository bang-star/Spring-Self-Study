# 1.3.4 원칙과 패턴(p.85 ~ 86)

## 높은 응집도와 늦은 결합도

- 개방 폐쇄 원칙은 높은 응집도와 낮은 결합도(high coherence and low coupling)라는 소프트웨어 개발의 고전적인 원리로도 설명이 가능하다.
  
  - 응집도가 높다

    하나의 모듈 또는 클래스가 하나의 책임 또는 관심사에만 집중되어 있다는 것을 의미한다.

    불필요하거나 직접 관련이 없는 외부의 관심과 책임이 얽혀 있지 않으며, 하나의 공통 관심사는 한 클래스에 모여 있다.

  - 높은 응집도는 클래스 레벨뿐 아니라, 패키지, 컴포넌트, 모듈에 이르기까지 그 대상의 크기가 달라도 동일한 원리로 적용될 수 있다.

<br />

### 높은 응집도

  - 예시
    
    응집도가 높다는 것은 변화가 일어날 때 해당 모듈에서 변하는 부분이 크다는 것을 의미한다.
    즉, 변경이 일어날 때 모듈의 많은 부분이 함께 바뀐다면 응집도가 높다고 말할 수 있다.

    만약 모듈의 일부분에만 변경이 일어나도 된다면, 모듈 전체에서 어떤 부분이 바뀌어야 하는지 파악해야하고 그 변경으로 인해 바뀌지 않는 부분에는 다른 영향을 미치지는 않는지 확인해야 하는 이중의 부담이 생긴다.

<br />

```
* 초난감 DAO 코드

처음에 만든 초난감 DAO에서 DB 커넥션을 만드는 기능을 DriverManager를 이용한 방법에서 다른 DB 커넥션 풀 라이브러리를 사용하는 방법으로 변경한다고 했을 때

초난감 DAO처럼 여러 관심사와 책임이 얽혀 있는 복잡한 코드에서는 변경이 필요한 부분을 찾아내는 것도 번거로운 일일뿐더러, 그렇게 변경한 것이 DAO의 다른 기능에 영향을 줘서 오류를 발생시키지 않는지 일일이 확인해야 한다.


* 수정된 UserDao 코드

ConnectionMaker 인터페이스를 이용해 DB 연결 기능을 독립시킨 경우라면, DB 커넥션 풀을 활용하는 ConnectionMaker 구현 클래스를 새로 만들기만 하면 된다. 

작업은 항상 전체적으로 무엇을 변경할지 명확하며, UserDao 등 다른 클래스의 수정을 요구하지 않고 기능에 영향을 주지 않는다는 사실을 손쉽게 확인할 수 있다. 

DB 연결 방식에 변경이 일어난 경우에 이를 검증하려고 한다면, 변경한 ConnectionMaker 구현 클래스를 직접 테스트해보는 것만으로도 충분하다. 


* 새로운 가정

기존의 NConnectionMaker를 개선해서 버전 2.0으로 만들었을때 수정된 NConnectionMaker를 테스트하기 위해 이를 사용하는 모든 DAO를 다 일일이 테스트해야 할까? 

정답은 X
ConnectionMaker를 분리하여 응집도를 높인 덕분에 NConnectionMaker를 직접 테스트해도 충분하다. 
```

<br />
<hr />
<br />

### 낮은 결합도

- 낮은 결합도는 높은 응집도보다 더 민감한 원칙이다.
- 책임과 관심사가 다른 오브젝트 또는 모듈과 낮은 결합도, 즉 느슨하게 연결된 형태를 유지하는 것이 바람직하다.

  - 느슨한 연결은 관계를 유지하는 데 꼭 필요한 최소한의 방법만 간접적인 형태로 제공하고, 나머지는 서로 독립적이고 알 필요도 없게 만들어주는 것이다.

  - 결합도가 낮아지면 변화에 대응하는 속도가 높아지고, 구성이 깔끔해지며 확장이 편리하다.

> 결합도는 "하나의 오브젝트가 변경이 일어날 때에 관계를 맺고 있는 다른 오브젝트에게 변화를 요구하는 정도"를 의미한다.

<br />

- 낮은 결합도는 하나의 변경이 발생할 때 여타 모듈과 객체로 변경에 대한 요구가 전파되지 않는 상태를 의미한다.

> 결합도가 높아지면 변경에 따르는 작업량이 많아지고, 변경으로 인해 버그가 발생할 가능성이 높아진다.

